@prefix  rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix  icm: <http://tio.models.tmforum.org/tio/v1.0.0/IntentCommonModel#> .
@prefix  imo: <http://tio.models.tmforum.org/tio/v1.0.0/IntentManagementOntology#> .
@prefix  pbi: <http://tio.models.tmforum.org/tio/v1.0.0/ProposalBestIntent#> .
@prefix  cat: <http://www.operator.com/Catalog#> .
@prefix spot: <http://www.sdo1.org/Models/DynamicpriceOntology#> .
@prefix  met: <http://www.sdo2.org/TelecomMetrics/Version_1.0#> .
@prefix    t: <http://www.w3.org/2006/time#> .
@prefix   ex: <http://www.example.org/IntentNamespace#> .
@prefix   iv: <https://tmforum.org/2021/07/intentValidity#> .
@prefix  itv: <https://tmforum.org/2021/07/intentTemporalValidity#> .
@prefix  cem: <http://tio.labs.tmforum.org/tio/v1.0.0/CatalystExtensionModel#> .
@prefix  xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix  arc: <http://tio.models.tmforum.org/tio/v1.0.0/IntentAcceptanceControl/> .

# --- Intent ------------------------------------------------------------------ 
#  This intent represents the Spot Price Bid Request from PSE (Price Sentitive
#  Enterprize) Customer to the business layer.
#  It is the B1 intent in the IDAN Catalyst Phase 2
#
#  The PSE customer orders a capability to be delivered. A capability is an 
#  abstract product that is not directly mapped to the product offering of a 
#  single service provider. It can rather be delivered by the capability 
#  marketplace choosing an appropriate product from any of the associated
#  service providers. 
#
#  This intent provides the requirements for choosing a service/product from
#  a service provider that would deliver the wanted capability with respect to
#  functional and non-functional requirements:
#
#  Functional requirement: 
#       -> Connectivity shall be provided between two sites
#
#  Non Functional requirements:
#       -> A minimum bandwidth of 1 GBit/s shall be available
#       -> The price shall not exceed 10 USD/h
#
#  Intent reports would keep the intent owner informed about current handling
#  state. This includes current values for the property parameters regarding
#  price and available bandwidth.
#
#  The customer is ok with the capability not delivered immediately. This 
#  means the customer is fine with a degraded intent. In order to emsure
#  that the intent handler does not reject the itnent, becasue it cannot
#  immediately fulfill it, the intent acceptence and rejection control 
#  extension model is used to override certain rejection reasons. 
#  

#  Decision go with Capability.  (Reminder: check Doug's blog!  Capability is also being done in ontology also TIO and CO!!  No Catalog!)
# Introduce a  class called Capability. A Taxonomy (hierarchy)   of capabilities with subclasses.. Joerg: this is why we have 2 ways of defining
# DeliveryExpectation..by pointer to catalog or Class  "DeliveryType". Current approach is Catalog-driven....
#
# --- B1 Intent - this is a SET INTENT Operation ( dont use  BEST )----------
# if we use a BEST we would only get reports on price....its still a hyposthetic "what-if" scenario.
# whereas, set is a active intent..
ex:B1_PSE_Biz_Intent1
  a icm:Intent ;
  rdfs:comment "'Intent for ordering connectivity service via dynamic pricing'" ;
  imo:intentOwner ex:IntentManagerXYZ ;
  cem:layer "'business'" ;
  arc:intentRejectionReasonOverride imo:SuccessfulHandlingNotExpected ;
  arc:updateRejectionReasonOverride imo:SuccessfulHandlingNotExpected ;
  icm:hasExpectation ex:PSE_Exp_delivery ,
                     ex:PSE_Capability_delivery_Param_type ,
                     ex:PSE_spot_price_bid_proposal ,
                     ex:PSE_Exp_reporting ; 
.

# --- Targets -----------------------------------------------------------------
# the latest intent common model introduced target onjects to be used instead 
# of blank nodes. 
# The target used here specifies a condition for selecting a valid resource 
# for fulfilling the expectations. It tells that one of the resources from a
# container shall be used. Thie deliberately leaves a choice to the intent 
# handler. 
# Here, the container to choose from is determined by the condition property
# icm:elementType. This means all individuals of the specified class are 
# elements of that container. Here, the container contains all resources. 
# This is the widest possible defintion, because everything is a resource in 
# rdf. 
# This means that the target defintion tells to choose exactly one element
# from the container of all resources and use that to fulfill the expextations 
# associated with this target.
# The resource conditions in the Target are 
# The target itself is otherwise an empty Container, because a choice of 
# resources was not yet done when creating the intent. The intent report
# will however drop the condition and provide a concrete container of 
# resources that were selected. 
ex:T1_Capability 
  a icm:IndividualTarget ;
  icm:oneOf [ icm:elementType rdf:Resource ];
.

# --- Delivery Expectation and Parameters -------------------------------------
# The delivery expectaion refers to a service description in the marketplace
# catalog for specifying what needs to be delivered. This means we are using
# a catalog based approach. 
#
# This intent also uses a type/class based specification of what shall be 
# deliverd 
#
# The delivery expectation expresses the requirement that something shall be
# delivered. It also describes the nature of this something. This practically
# steers the selection of target resources. In this case the target is an
# empty container and 
# The system is compliant to this type of expectation if the respective 
# resources, which were selected to fulfill this delivery, meet the 
# requirements of the delivery expectation. 
# This something
#
ex:PSE_Exp_delivery
  a icm:DeliveryExpectation ;
  icm:target ex:T1_Capability ;
  icm:hasParameter ex:PSE_Capability_delivery_Param_type ;
.

ex:PSE_Capability_delivery_Param_type
  a icm:DeliveryParameter ;
  icm:deliveryDescription cat:Connectivity_DynamicPrice ; 
  icm:deliveryType ex:ConnectivityCapability_DynamicPrice ; 
.

# --- Proposal Expectation ----------
# Not needed, becasue the regular reporting would already provide the information
# needed about current price.


# --- Property Expectation ----------------------------------------------------
ex:PSE_Exp_property
  a icm:PropertyExpectation ;
  icm:target _:capability ;
  icm:allOf [ rdf:li ex:PSE_Exp_Param_price ;
              rdf:li ex:PSE_Exp_Param_bandwidth ;
              rdf:li ex:PSE_Exp_Param_Location ;
			] ;
.

ex:PSE_Exp_Param_price
  a icm:PropertyExpectation ;
  icm:observation [ icm:latestValueOf spot:price ] ;
  icm:atMost "10" ;
  icm:hasUnit [ icm:unit spot:unitDollarHour ] ;
.
ex:PSE_Exp_property_Param_bandwidth  
  a icm:PropertyParameter ;  
  icm:observation [ icm:latestValueOf met:AvailableBandwidth ] ;
  icm:atLeast "1" ;
  icm:hasUnit [ icm:unit "GBit/s" ] ;
.
ex:PSE_Exp_property_Param_Location
  a icm:PropertyParameter ;
  icm:subject [ rdf:li "'locationA'" ;
                rdf:li "'locationB'" ;
              ] ;
  icm:includedIn met:ConnectedLocations ;
.
#  alternative parameter expression using statements
ex:PSE_Exp_property_Param_bandwidth  
  a icm:PropertyParameter ;  
  icm:resultFrom [ rdf:subject [ icm:latestValueOf met:AvialableBandwidth ] ;
                   rdf:predicate icm:atLeast ;
				   rdf:object  [ rdf:value "1" ;
				                 icm:hasUnit [ icm:unit "GBit/s" ]
				               ] ;
                 ] ;
.
  
ex:PSE_Exp_property_Param_Location
  a icm:PropertyParameter ;
  icm:resultFrom [ rdf:subject [ rdf:li "'locationA'" ;
                                 rdf:li "'locationB'" ;
                               ] ;
                   rdf:predicate icm:includedIn ;
	               rdf:object met:ConnectedLocations ;
                 ] ; 
.


# --- Reporting Expectation ---------------------------------------------------
# Ask for reporting about key events and regular reports every 10 minutes
# A proposal expectation is not needed, because the regular reporting would 
# provide the same information. 
# The scope of the reporting is the entire intent as indicated by the target
# The receiver of the report is the itnent managment Function of Customer1. It
# is represented by the resource ex:IMF_Customer1
# 
ex:PSE_Exp_reporting
  a icm:ReportingExpectation ;
  icm:target ex:B1_PSE_Biz_Intent1 ;
  icm:receiver ex:IMF_Customer1 ;
  icm:anyOf [ rdf:li ex:PSE_Exp_reporting_Param_interval ;
              rdf:li ex:PSE_Exp_reporting_Param_event ;
			] ;
.
ex:PSE_Exp_reporting_Param_interval
 a icm:ReportingParameter ;
 icm:reportingEvent [ a rdf:bag ;
                    ] ;
 
 icm:reportingTime
   icm:reportingInterval [ a t:Duration ;
                                t:numericDuration "'10'" ;
                                t:temporalUnit t:unitMinute ] .
ex:PSE_Exp_reporting_Param_event              
 a icm:ReportingParam ; 
   icm:reportingEvent icm:ReportingIntervalExpired ,
                        icm:IntentRejected ,
                        icm:StateComplies ,
                        icm:StateDegrades ,
                        icm:HandlingEnded ,
                        icm:UpdateRejected ,
                        icm:UpdateFinished  ;
.
